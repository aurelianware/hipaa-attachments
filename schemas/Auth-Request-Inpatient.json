{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://aurelianware.com/schemas/auth-request-inpatient.json",
  "title": "Inpatient Authorization Request (X12 278 X217 - UM01=AR)",
  "description": "Schema for inpatient authorization requests supporting X12 278 Healthcare Services Review - Request for Review",
  "type": "object",
  "required": ["patient", "requestingProvider", "admission", "diagnosis", "service"],
  "properties": {
    "patient": {
      "type": "object",
      "required": ["memberId", "dateOfBirth", "gender"],
      "properties": {
        "memberId": {
          "type": "string",
          "pattern": "^[A-Z0-9]{1,80}$",
          "description": "Member identifier (NM109)"
        },
        "firstName": {
          "type": "string",
          "maxLength": 35,
          "description": "Patient first name (NM104)"
        },
        "lastName": {
          "type": "string",
          "maxLength": 60,
          "description": "Patient last name (NM103)"
        },
        "dateOfBirth": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "Date of birth in YYYY-MM-DD format (DMG02)"
        },
        "gender": {
          "type": "string",
          "enum": ["M", "F", "U"],
          "description": "Gender code: M=Male, F=Female, U=Unknown (DMG03)"
        },
        "relationship": {
          "type": "string",
          "enum": ["01", "18", "19", "20", "21", "39", "40", "53"],
          "description": "Relationship to subscriber: 18=Self, 01=Spouse, 19=Child, 20=Employee, 21=Unknown, 39=Organ Donor, 40=Cadaver Donor, 53=Life Partner"
        }
      }
    },
    "subscriber": {
      "type": "object",
      "description": "Subscriber information if patient is a dependent",
      "properties": {
        "memberId": {
          "type": "string",
          "pattern": "^[A-Z0-9]{1,80}$"
        },
        "firstName": {
          "type": "string",
          "maxLength": 35
        },
        "lastName": {
          "type": "string",
          "maxLength": 60
        }
      }
    },
    "requestingProvider": {
      "type": "object",
      "required": ["npi"],
      "properties": {
        "npi": {
          "type": "string",
          "pattern": "^\\d{10}$",
          "description": "National Provider Identifier (10 digits, NM109)"
        },
        "firstName": {
          "type": "string",
          "maxLength": 35,
          "description": "Provider first name for individuals (NM104)"
        },
        "lastName": {
          "type": "string",
          "maxLength": 60,
          "description": "Provider last name for individuals (NM103)"
        },
        "organizationName": {
          "type": "string",
          "maxLength": 60,
          "description": "Organization name for facilities (NM103)"
        },
        "address": {
          "type": "object",
          "properties": {
            "street1": {"type": "string", "maxLength": 55},
            "street2": {"type": "string", "maxLength": 55},
            "city": {"type": "string", "maxLength": 30},
            "state": {"type": "string", "pattern": "^[A-Z]{2}$"},
            "zipCode": {"type": "string", "pattern": "^\\d{5}(-\\d{4})?$"}
          }
        },
        "phone": {
          "type": "string",
          "pattern": "^\\d{10}$",
          "description": "10-digit phone number"
        }
      }
    },
    "facility": {
      "type": "object",
      "description": "Facility information for inpatient admissions",
      "properties": {
        "npi": {
          "type": "string",
          "pattern": "^\\d{10}$"
        },
        "name": {
          "type": "string",
          "maxLength": 60
        },
        "address": {
          "type": "object",
          "properties": {
            "street1": {"type": "string", "maxLength": 55},
            "city": {"type": "string", "maxLength": 30},
            "state": {"type": "string", "pattern": "^[A-Z]{2}$"},
            "zipCode": {"type": "string", "pattern": "^\\d{5}(-\\d{4})?$"}
          }
        }
      }
    },
    "admission": {
      "type": "object",
      "required": ["admissionDate"],
      "properties": {
        "admissionDate": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "Admission date in YYYY-MM-DD format (DTP*AAH*D8)"
        },
        "dischargeDate": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "Estimated discharge date (optional)"
        },
        "admissionType": {
          "type": "string",
          "description": "CL101 - Admission Type Code: 1=Emergency, 2=Urgent, 3=Elective, 4=Newborn, 5=Trauma Center",
          "enum": ["1", "2", "3", "4", "5", "6", "7", "8", "9"]
        },
        "admissionSource": {
          "type": "string",
          "description": "CL102 - Admission Source Code: 1=Physician Referral, 2=Clinic Referral, 4=Transfer from Hospital, 5=Transfer from SNF, 6=Transfer from Another HCF, 7=Emergency Room, 8=Court/Law Enforcement, 9=Information Not Available",
          "enum": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F"]
        }
      }
    },
    "diagnosis": {
      "type": "array",
      "minItems": 1,
      "maxItems": 12,
      "description": "Diagnosis codes (at least 1 required, maximum 12)",
      "items": {
        "type": "object",
        "required": ["code"],
        "properties": {
          "code": {
            "type": "string",
            "pattern": "^[A-Z0-9.]{3,7}$",
            "description": "ICD-10-CM diagnosis code"
          },
          "codeType": {
            "type": "string",
            "enum": ["ABK", "ABF"],
            "default": "ABK",
            "description": "Code type: ABK=ICD-10-CM Principal Diagnosis, ABF=ICD-10-CM Diagnosis"
          }
        }
      }
    },
    "service": {
      "type": "object",
      "required": ["serviceType"],
      "properties": {
        "serviceType": {
          "type": "string",
          "description": "UM03 - Service Type Code (e.g., 1=Medical Care, 47=Inpatient Hospital Room and Board, 48=Hospital Inpatient)",
          "pattern": "^\\d{1,3}$"
        },
        "placeOfService": {
          "type": "string",
          "description": "UM04 - Place of Service Code: 21=Inpatient Hospital, 22=Outpatient Hospital, 23=Emergency Room Hospital",
          "pattern": "^\\d{2}$"
        },
        "quantity": {
          "type": "number",
          "minimum": 1,
          "description": "Service quantity (number of days for inpatient)"
        },
        "quantityType": {
          "type": "string",
          "enum": ["DY", "UN"],
          "default": "DY",
          "description": "Quantity type: DY=Days, UN=Units"
        }
      }
    },
    "procedures": {
      "type": "array",
      "maxItems": 16,
      "description": "Procedure codes (situational for inpatient, maximum 16)",
      "items": {
        "type": "object",
        "required": ["code"],
        "properties": {
          "code": {
            "type": "string",
            "description": "CPT, HCPCS, or ICD-10-PCS procedure code"
          },
          "codeType": {
            "type": "string",
            "enum": ["HC", "IJ", "IV"],
            "description": "Code type: HC=HCPCS/CPT, IJ=ICD-10-PCS, IV=ICD-9-PCS"
          },
          "modifier": {
            "type": "string",
            "pattern": "^[A-Z0-9]{2}$",
            "description": "Procedure modifier (2 characters)"
          }
        }
      }
    },
    "providerMessage": {
      "type": "string",
      "maxLength": 264,
      "description": "Additional provider message or notes"
    },
    "attachmentRequired": {
      "type": "boolean",
      "default": false,
      "description": "Flag to trigger attachment workflow during submission"
    }
  }
}
