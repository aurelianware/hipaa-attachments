{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://aurelianware.com/schemas/auth-response.json",
  "title": "Authorization Response",
  "description": "Unified response schema for all authorization request types (X12 278 X217 responses)",
  "type": "object",
  "required": ["status", "certificationTypeCode"],
  "properties": {
    "authorizationNumber": {
      "type": "string",
      "description": "Authorization reference number if approved or pended (REF*D9)"
    },
    "status": {
      "type": "string",
      "enum": ["APPROVED", "PENDED", "DENIED", "MODIFIED", "ERROR"],
      "description": "High-level authorization status"
    },
    "certificationTypeCode": {
      "type": "string",
      "description": "X12 certification type code from STC segment",
      "enum": [
        "A1",
        "A2",
        "A3",
        "A4",
        "A6",
        "A7",
        "CT",
        "NA"
      ],
      "enumDescriptions": {
        "A1": "Certified in Total",
        "A2": "Certified Partial",
        "A3": "Denial",
        "A4": "Pended",
        "A6": "Modified",
        "A7": "Cancelled",
        "CT": "Conditional",
        "NA": "Not Applicable"
      }
    },
    "effectiveDate": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "description": "Authorization effective date (DTP*472)"
    },
    "expirationDate": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "description": "Authorization expiration date (DTP*473)"
    },
    "serviceType": {
      "type": "string",
      "description": "Service type code (UM03)"
    },
    "authorizedQuantity": {
      "type": "number",
      "minimum": 0,
      "description": "Authorized quantity (HSD02)"
    },
    "quantityType": {
      "type": "string",
      "enum": ["DY", "HR", "MO", "UN", "VS"],
      "description": "Authorized quantity type: DY=Days, HR=Hours, MO=Months, UN=Units, VS=Visits"
    },
    "decision": {
      "type": "string",
      "description": "Human-readable decision summary"
    },
    "decisionReason": {
      "type": "string",
      "description": "Reason for decision (especially for denials)"
    },
    "messages": {
      "type": "array",
      "description": "Additional messages from payer",
      "items": {
        "type": "string"
      }
    },
    "errors": {
      "type": "array",
      "description": "Errors from AAA segment if applicable",
      "items": {
        "type": "object",
        "properties": {
          "code": {"type": "string"},
          "description": {"type": "string"},
          "followUpAction": {"type": "string"}
        }
      }
    },
    "patient": {
      "type": "object",
      "description": "Patient information echoed from request",
      "properties": {
        "memberId": {"type": "string"},
        "firstName": {"type": "string"},
        "lastName": {"type": "string"},
        "dateOfBirth": {"type": "string"},
        "gender": {"type": "string"}
      }
    },
    "provider": {
      "type": "object",
      "description": "Provider information echoed from request",
      "properties": {
        "npi": {"type": "string"},
        "firstName": {"type": "string"},
        "lastName": {"type": "string"},
        "organizationName": {"type": "string"}
      }
    },
    "referredToProvider": {
      "type": "object",
      "description": "Referred-to provider (for referrals only)",
      "properties": {
        "npi": {"type": "string"},
        "firstName": {"type": "string"},
        "lastName": {"type": "string"},
        "organizationName": {"type": "string"},
        "specialty": {"type": "string"}
      }
    },
    "services": {
      "type": "array",
      "description": "Authorized service details",
      "items": {
        "type": "object",
        "properties": {
          "serviceType": {"type": "string"},
          "fromDate": {"type": "string"},
          "toDate": {"type": "string"},
          "quantity": {"type": "number"},
          "quantityType": {"type": "string"}
        }
      }
    },
    "attachmentRequired": {
      "type": "boolean",
      "description": "Whether attachment submission is required"
    },
    "reviewedAt": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp when payer reviewed the request"
    },
    "reviewedBy": {
      "type": "string",
      "description": "Payer reviewer or system identifier"
    }
  }
}
